
# Configuração de Cron para Backups Automáticos com pgBackRest


# Variáveis de ambiente
SHELL=/bin/bash
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin


# Agendamento de Backups


# Backup COMPLETO (Full) - Domingos às 02:00
0 2 * * 0 postgres pgbackrest --stanza=star_wars backup --type=full >> /var/log/pgbackrest/cron.log 2>&1

# Backup DIFERENCIAL - Quartas às 02:00
0 2 * * 3 postgres pgbackrest --stanza=star_wars backup --type=diff >> /var/log/pgbackrest/cron.log 2>&1

# Backup INCREMENTAL - Todos os dias às 03:00 (exceto domingo e quarta)
0 3 * * 1,2,4,5,6 postgres pgbackrest --stanza=star_wars backup --type=incr >> /var/log/pgbackrest/cron.log 2>&1

# Verificação de integridade do backup - Sábados às 04:00
0 4 * * 6 postgres pgbackrest --stanza=star_wars check >> /var/log/pgbackrest/cron.log 2>&1

# Limpeza de backups antigos (baseado na política de retenção) - Domingos às 05:00
0 5 * * 0 postgres pgbackrest --stanza=star_wars expire >> /var/log/pgbackrest/cron.log 2>&1
